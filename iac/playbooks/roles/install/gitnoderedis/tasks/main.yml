---
- name: Install Git and Redis
  yum:
    name:
      - git
      - redis
    state: latest

- name: Download Node.js setup script
  get_url:
    url: https://rpm.nodesource.com/setup_14.x
    dest: /opt
    mode: 755

- name: Setup Node.js to use v14
  command: /opt/setup_14.x

- name: Install Node.js
  yum:
    name: nodejs


# - name: Enable and start sshd
#   service:
#     name: sshd
#     state: started
#     enabled: yes

# --------------- GITHUB AND REPO KEYS --------------- #

- name: Copy OpenSSH private key
  become: no
  copy:
    content: '-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACBviea+H9tIn0dEob0dj4ABcJvnrzTAYgIyEtYB3cAnTgAAAJhNEe3DTRHt
wwAAAAtzc2gtZWQyNTUxOQAAACBviea+H9tIn0dEob0dj4ABcJvnrzTAYgIyEtYB3cAnTg
AAAEDW9R5/mZdVGZ0KYpbRB+atUgKp57moLojM1DVZTMBWXG+J5r4f20ifR0ShvR2PgAFw
m+evNMBiAjIS1gHdwCdOAAAAEnNlcmdlaUBhZGFsdGFzLmNvbQECAw==
-----END OPENSSH PRIVATE KEY-----'
    dest: ~/.ssh/id_ed25519

- name: Copy .pub file
  become: no
  copy:
    content: 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG+J5r4f20ifR0ShvR2PgAFwm+evNMBiAjIS1gHdwCdO sergei@adaltas.com'
    dest: ~/.ssh/id_ed25519.pub

# ----------------------- TRUCS A TEJ ---------------------- #
# - name: Touching a hosts doc
#   become: no
#   file: 
#     path: ~/.ssh/known_hosts
#     state: touch
#     mode: '0777'

# - name: Adding Github as a known host
#   become: no
#   shell: 'ssh-keyscan -H github.com >> ~/.ssh/authorized_keys'

# - name: Enable HTTP+HTTPS access
#   firewalld:
#     # This is how we use a variable
#     service: "{{ item }}"
#     permanent: yes
#     state: enabled
#   # The module will be run for each item
#   with_items:
#     - http
#     - https

# - name: Reload firewalld
#   service:
#     name: firewalld
#     state: reloaded

